# IDEACODE Framework - AI Instructions

**Project:** IDEACODE - Autonomous Development Framework
**Version:** 8.5
**Profile:** Library/Framework
**Location:** `/Volumes/M-Drive/Coding/ideacode`

---

## MANDATORY RULES

### 1. MCP Tool Usage (CRITICAL)
**DEFAULT:** Always use MCP tools for IDEACODE operations.

| Operation | MCP Tool |
|-----------|----------|
| Specifications | `ideacode_specify` |
| Planning | `ideacode_plan` |
| Implementation | `ideacode_implement` |
| Testing | `ideacode_test` |
| Git commits | `ideacode_commit` |
| Archiving | `ideacode_archive` |
| Standards | `ideacode_standards` |
| Hash-tags | `ideacode_capture_hashtag` |

**Skip MCP only when:** User explicitly says "don't use MCP tools".

### 2. Branch-Based Development
- **ALWAYS** create feature branches: `feature/{category}/{description}`
- **NEVER** commit directly to `main` or `master`
- Use: `feature/`, `bugfix/`, `refactor/`, `hotfix/`, `experiment/`
- Keep branches short-lived (<2 weeks, <50 commits)
- Create PRs for all merges, squash merge, delete branch after

### 3. Modular Architecture
**All shared code in master repository:**
```
/Volumes/M-Drive/Coding/ideacode/libraries/
├── core/          # Auth, logging, networking
├── ui/            # Design system, components
├── data/          # Repository, cache, sync
├── network/       # API client, GraphQL
├── security/      # Auth, biometric, encryption
├── voice/         # Recognition, DSL parser
└── platform/      # Filesystem, permissions
```

**NEVER:** Copy-paste code between projects.
**ALWAYS:** Use library imports.

### 4. Iterative Code Review Loop (v8.5)
After each phase, repeat until clean:
1. **Code Review** - 98-point checklist (completeness, consistency, tests, security, docs, performance)
2. **Categorize** - Blockers vs Warnings
3. **Fix** - Track retry count
4. **Auto-Research** - If >3 failed attempts, use `WebSearch`
5. **Re-Review** - Verify fixes
6. **Repeat** until: 0 blockers, 0 warnings, 100% tests pass, coverage >= 90%

### 5. Context Check Every 5 Exchanges
1. Check context usage (estimate tokens)
2. If >60%: Auto-archive completed work
3. Update tasks.md with progress
4. Maintain 80K+ free tokens

### 6. UI Theming (Per-Project)
Each app has separate theming module in `app/src/.../ui/theme/`:
- Abstraction layer (AppColors, AppTypography)
- IdeaMagic theme (for Avanues ecosystem)
- Material theme (for standalone)
- Runtime detection + user override

### 7. No AI Attribution
**NEVER** include in commits: "Generated with Claude", "Co-Authored-By: Claude", emojis.

---

## Quality Gates

| Metric | Target |
|--------|--------|
| Test Coverage | 90%+ (critical paths) |
| IPC Coverage | 100% |
| API Documentation | 100% (OpenAPI 3.0) |
| Intent Registration | 100% |

---

## MCP Tools (34 Total)

### Workflow (4)
- `ideacode_specify` - Create feature specification
- `ideacode_plan` - Generate implementation plan
- `ideacode_implement` - Execute implementation
- `ideacode_archive` - Archive completed features

### Quality (2)
- `ideacode_validate` - Validate spec format
- `ideacode_test` - Run tests and analyze failures

### Project (3)
- `ideacode_list` - List features/specs/archive
- `ideacode_commit` - Git commit
- `ideacode_new_project` - Project setup

### Analysis (4)
- `ideacode_issue` - Issue analysis (ToT/CoT)
- `ideacode_think` - Extended thinking
- `ideacode_research` - Web research
- `ideacode_analyze_ui` - UI screenshot analysis

### Vision (3)
- `ideacode_from_mockup` - Generate code from mockup
- `ideacode_debug_screenshot` - Debug from screenshot
- `ideacode_analyze_ui` - UI analysis

### Checkpoint (3)
- `ideacode_checkpoint` - Checkpoint before major actions
- `ideacode_learn` - Record outcomes for patterns
- `ideacode_patterns` - Get detected patterns

### Constitution (6)
- `ideacode_constitution_set` - Set session rules
- `ideacode_constitution_check` - Get effective rules
- `ideacode_constitution_reset` - Reset to defaults
- `ideacode_constitution_add_rule` - Add rule
- `ideacode_constitution_remove_rule` - Remove rule
- `ideacode_constitution_validate` - Validate action

### Standards (1)
- `ideacode_standards` - Load programming standards by file/context/project

### Hash-Tags (5)
- `ideacode_capture_hashtag` - Capture inline standards
- `ideacode_validate_hashtag` - Validate without capturing
- `ideacode_list_hashtags` - List captured standards
- `ideacode_detect_hashtags` - Detect in message
- `ideacode_promote_standard` - Promote to global

### Advanced (3)
- `ideacode_port_module` - Port modules with IPC
- `ideacode_context_reset` - Reset context
- `ideacode_context_show` - Show context usage

---

## Hash-Tag Inline Capture

Zero-friction knowledge capture during conversation.

### Supported Tags
| Tag | Purpose | Destination |
|-----|---------|-------------|
| `#global` | Universal standard | `design-standards/{category}/` |
| `#project` | Project-specific | `.ideacode/design-standards/` |
| `#test` | Test case | `tests/{slug}.test.ts` |
| `#backlog` | Future work | `backlog/{number}-{slug}.md` |
| `#security` | Security standard | `design-standards/security/` |
| `#docs` | Documentation | `docs/{slug}.md` |
| `#ideacode-update` | Framework change | Enhanced checkpoint |

### Example
```
User: Build auth. #global Use PKCE for public clients. #test Should reject expired tokens.
```

---

## Programming Standards

### Available Standards (5)
1. `ideacode-core.md` - Core principles (always loaded)
2. `security-owasp.md` - OWASP Top 10
3. `swarm-mode-scrum-master.md` - Multi-agent coordination
4. `avanues-dsl.md` - Voice-first DSL
5. `cot-configuration.md` - Chain of Thought

### Usage
```bash
# By file extension
ideacode_standards --file src/UserService.kt

# By context
ideacode_standards --context "implement OAuth2"

# By project type
ideacode_standards --project /path/to/project
```

**Location:** `/Volumes/M-Drive/Coding/ideacode/programming-standards/`

---

## Protocols Reference

**Location:** `/Volumes/M-Drive/Coding/ideacode/protocols/`

| Protocol | Purpose |
|----------|---------|
| `Protocol-Context-Management-v2.0.md` | 95% automated context (v8.3) |
| `Protocol-Code-Review-v1.0.md` | Iterative review loop (v8.5) |
| `Protocol-Q&A-Interaction-Pattern-v1.0.md` | Present options before asking |
| `Protocol-Optimal-Solution-v1.0.md` | Best-of-best solutions |
| `Protocol-File-Organization-v2.0.md` | File structure |
| `Protocol-YOLO-Mode.md` | Full automation |
| `Protocol-Zero-Tolerance-Pre-Code.md` | Quality gates |
| `Protocol-Modular-Architecture-v1.0.md` | Modularity |
| `Protocol-Mandatory-Branching-v1.0.md` | Branch requirements |
| `Protocol-UI-Theming-Architecture-v1.0.md` | Theming |

---

## Framework Configuration

**File:** `/Volumes/M-Drive/Coding/ideacode/.ideacode/config.yml`

```yaml
version: "8.4"
framework_path: "/Volumes/M-Drive/Coding/ideacode"
project_name: "IDEACODE-Framework"
profile: "library"
voice_first: true
```

---

## Project Registry

**File:** `/Volumes/M-Drive/Coding/ideacode/PROJECT-REGISTRY.json`

| Project | Type | Priority |
|---------|------|----------|
| IDEACODE | framework | 1 |
| AVA | android-app | 2 |
| AvaConnect | android-app | 2 |
| Avanues | android-platform | 2 |
| VoiceOS | voice-os | 3 |
| NewAvanue | android-platform | 2 |

---

## Key Directories

```
/Volumes/M-Drive/Coding/ideacode/
├── .ideacode/          # Framework config
├── ideacode-mcp/       # MCP server source
├── protocols/          # Master protocols
├── templates/          # Project templates
├── programming-standards/  # Standards registry
├── design-standards/   # Captured hash-tags
├── libraries/          # Shared libraries
├── scripts/            # Automation
└── archive/            # Completed features
```

---

## Changelog v8.5

### Iterative Code Review Loop with Auto-Research
- Iterative review until clean (Code → Review → Fix → Re-Review)
- Auto-research for persistent errors (after 3 attempts)
- WebSearch integration
- 0 blockers/warnings required before commit

### Previous (v8.3)
- 95% automated context management
- Auto-archival at 60% threshold
- Markdown scratchpad system

---

## Continuous Learning

Capture lessons in `/backlog/`:
1. Create backlog item (sequential numbering)
2. Document: what, why, evidence, application
3. Commit immediately

---

## Optimal Solution Requirement

When presenting options:
1. Present 2-4 standard options with pros/cons
2. Synthesize optimal solution (best-of-best)
3. Provide clear recommendation

---

## Author

**Name:** Manoj Jhawar
**Email:** manoj@ideahq.net
**License:** Proprietary

---

**Last Updated:** 2025-11-17 | **IDEACODE Version:** 8.4
