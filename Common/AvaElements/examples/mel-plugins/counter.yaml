# counter.yaml
# A simple counter plugin - minimal example for learning MEL
# Tier: data (Apple-safe, uses only basic functions)
#
# Features:
# - Increment/decrement counter
# - Reset to zero
# - Demonstrates basic state management

plugin:
  id: "com.augmentalis.counter"
  name: "Counter"
  version: "1.0.0"
  description: "A simple counter to demonstrate MEL basics"
  tier: data

state:
  count: 0               # The counter value

reducers:
  # Increment counter by 1
  increment:
    next_state:
      count: $math.add($state.count, 1)

  # Decrement counter by 1
  decrement:
    next_state:
      count: $math.subtract($state.count, 1)

  # Reset counter to 0
  reset:
    next_state:
      count: 0

  # Add custom amount
  addAmount:
    params: [amount]
    next_state:
      count: $math.add($state.count, $amount)

ui:
  Column:
    style:
      padding: 24
      gap: 24
      alignItems: "center"
      justifyContent: "center"
    children:
      # Title
      - Text:
          value: "Counter"
          style:
            fontSize: 32
            fontWeight: "bold"
            color: "#333"

      # Counter display
      - Container:
          style:
            backgroundColor: "#f0f0f0"
            borderRadius: 16
            padding: 32
            minWidth: 200
          children:
            - Text:
                value: $string.concat("", $state.count)
                style:
                  fontSize: 72
                  fontWeight: "bold"
                  textAlign: "center"
                  color: $logic.if(
                    $logic.lt($state.count, 0),
                    "#cc0000",
                    $logic.if(
                      $logic.gt($state.count, 0),
                      "#00cc00",
                      "#666666"
                    )
                  )

      # Control buttons
      - Row:
          style:
            gap: 12
          children:
            - Button:
                label: "âˆ’"
                onTap: "decrement"
                variant: "outline"
                style:
                  width: 80
                  height: 80
                  fontSize: 36
            - Button:
                label: "Reset"
                onTap: "reset"
                variant: "secondary"
                style:
                  width: 100
                  height: 80
                  fontSize: 18
            - Button:
                label: "+"
                onTap: "increment"
                variant: "primary"
                style:
                  width: 80
                  height: 80
                  fontSize: 36

      # Quick add buttons
      - Column:
          style:
            gap: 8
            marginTop: 16
          children:
            - Text:
                value: "Quick Add"
                style:
                  fontSize: 14
                  color: "#666"
                  textAlign: "center"
            - Row:
                style:
                  gap: 8
                children:
                  - Button:
                      label: "+5"
                      onTap: "addAmount(5)"
                      variant: "ghost"
                      style:
                        fontSize: 14
                  - Button:
                      label: "+10"
                      onTap: "addAmount(10)"
                      variant: "ghost"
                      style:
                        fontSize: 14
                  - Button:
                      label: "+25"
                      onTap: "addAmount(25)"
                      variant: "ghost"
                      style:
                        fontSize: 14
                  - Button:
                      label: "+100"
                      onTap: "addAmount(100)"
                      variant: "ghost"
                      style:
                        fontSize: 14

      # Status message
      - Text:
          value: $logic.if(
            $logic.equals($state.count, 0),
            "Start counting!",
            $logic.if(
              $logic.gt($state.count, 0),
              $string.concat("You're up by ", $string.concat("", $state.count)),
              $string.concat("You're down by ", $string.concat("", $math.abs($state.count)))
            )
          )
          style:
            fontSize: 16
            color: "#999"
            fontStyle: "italic"
