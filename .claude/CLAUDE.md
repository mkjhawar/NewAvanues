# IDEACODE v10.3 - Global Instructions

Scope: ALL projects in /Volumes/M-Drive/Coding/

---

## SESSION START

1. Read `{project}/.claude/CLAUDE.md`
2. Read `{project}/.ideacode/registries/script-registry.md` (if exists)
3. Read `{module}/.claude/CLAUDE.md` for module work

---

## DOCUMENT LOADING (TOKEN OPTIMIZATION)

Rule: Summaries FIRST, full docs ONLY when insufficient

Start: `docs/QUICK-REFERENCE.md` or `docs/ideacode/protocols/INDEX.md`
Structure: `00-*.md` (summary ~200 tok), `01-*.md` (section ~400 tok), `99-*.md` (full)
Session: QUICK-REFERENCE + LD-CORE (~800 tok total)
Workflows: Use `00-Checklist.md` NOT full protocols
Penalty: Violating wastes 15k-30k tokens/workflow

---

## FILE OPERATIONS

1. Check registry: `/Volumes/M-Drive/Coding/ideacode/.ideacode/registries/FOLDER-REGISTRY.md`
2. **NO REDUNDANT FOLDER NAMES:** Parent name implies content → children MUST NOT repeat
   - ❌ `Common/Libraries/` → ✅ `Common/`
   - ❌ `Modules/libraries/` → ✅ `Modules/`
   - ❌ `Docs/Documentation/` → ✅ `Docs/`
3. Use MCP: `ideacode_fs` for all file ops (auto-validates)
4. Run: `ideacode_standards --context "task"`

Paths:
- Context: `{project}/contextsave/con-{app}-{module}-{desc}-{YYYYMMDD}.md`
- Living Docs: `{project}/.ideacode/living-docs/LD-App-Module-Desc-V#.md`
- Commands: `/Volumes/M-Drive/Coding/.claude/commands/` (GLOBAL ONLY)

---

## HARD RULES

| Rule | Enforcement |
|------|-------------|
| File reading | Read in chunks until found (debugging). No limit on chunk count. |
| Wait for user | STOP after questions, NEVER proceed until answered |
| Question format | Display ALL questions FIRST, then ask one-at-a-time (single submit) |
| Always "Other" | EVERY question must include "Other" option for user input |
| Options analysis | For each option: pros, cons, AI recommendation, optimal alternative, hybrid solutions |
| No delete | NEVER delete code without approval + pros/cons |
| Optimal only | Best approach always (hybrid OK), no "good enough" |
| Token efficiency | Batch ops, targeted reads, minimal output |
| Compact format | Tables/lists only, NO prose |
| CLAUDE.md | <150 lines, structured, no emojis |
| MCP tools | `ideacode_*` ONLY (NOT Write/mv/rm) |
| Branches | NEVER commit to main (`feature/`, `bugfix/`, `hotfix/`) |
| No duplication | Library imports, NEVER copy-paste |
| No AI marks | No "Generated by Claude", no emojis in commits |
| Test coverage | 90%+ critical paths |
| SOLID | ALL code |
| No redundant names | Parent implies type → children NEVER repeat (Common/ NOT Common/Libraries/) |

YOLO Mode:
- No questions within repo/branch scope (autonomous decisions)
- Only ask if: outside repo, external access, or affects main branch
- No shortcuts, re-enable disabled, 100% equivalence

---

## QUESTION-ASKING PROTOCOL

When asking questions:

1. **Display Phase:** Show ALL questions in message BEFORE asking
2. **Ask Phase:** Use AskUserQuestion tool with questions (user submits once for all)
3. **"Other" Required:** EVERY question MUST have "Other" option
4. **Options Analysis:** For each option provide:
   - Pros (benefits)
   - Cons (drawbacks/tradeoffs)
   - AI recommendation + reason
   - Optimal alternative (if different from options)
   - Hybrid solutions (combinations that may be better)

Example:
```
I need to decide on the authentication approach. Here are the questions:

Question 1: Which auth method?
Question 2: Where to store tokens?

[Then use AskUserQuestion with both questions, each with "Other" option]

For each option I'll provide:
- Option A: JWT
  Pros: Stateless, scalable
  Cons: Token size, rotation complexity
- Option B: Session
  Pros: Simple, revocable
  Cons: Server state, scaling issues
- Optimal: Hybrid (JWT + refresh tokens)
  Why: Combines stateless benefits with revocation
```

---

## AUTO-INVOKED

Always-On: SOLID enforcement, Reasoning (auto `.cot`/`.tot`/`.rot`), Skills (17), Subagents (13), Web search

Skills: develop-feature, fix-bug, create-ui, developing-{android|ios|web|kmp|tauri|kotlin|web}
Subagents: code-reviewer, security-scanner, architect, test-runner, doc-writer, performance-optimizer, spec-verifier, plan-verifier, impl-verifier, debug-agent, exploration-agent, research-agent, cleanup-agent

Ref: `LD-IDEACODE-AI-Instructions-V1.md`

---

## COMMANDS

Core: /idevelop /ifix /ispecify /iplan /iimplement /icreateui /ianalyze /ireview
Project: /iproject /imonorepo /isystem /iscan /idocument
Advanced: /iswarm /iagent /irefactor /ithink /iresearch /iwiz

Modifiers: .yolo .swarm .tdd .ood .solid .tcr .cot .tot .profile .code .ui .docs

Full: /ideacode or /imodifiers or `docs/ideacode-v10-manual.md`

---

## FILE NAMING

Docs: `App-Module-Desc-YYMMDD-V#.md` (versioned)
Living: `LD-App-Module-Desc-V#.md` (no date)
Specs: `App-Spec-Feature-YYMMDD-V#.md` (versioned)
Plans: `App-Plan-Feature-YYMMDD-V#.md` (versioned)
Handovers: `{App}-{Module}-Handover-{YYMMDD}-V#.md` (versioned)
Pre-compact: `pre-compact-{app}-{YYMMDDHHMM}.md` (timestamped)
Context: `context-{YYMMDDHHMM}.md` (timestamped)

Code:
- TypeScript: `{app}-{module}-{desc}.ts`
- Kotlin/Swift: `{App}{Module}{Desc}.{kt|swift}`

Folders:
- Gradle: `android/ios/desktop/` (lowercase)
- Other: `Docs/Common/Shared/` (PascalCase)
- Config: `.claude/.ideacode/` (kebab)

Date Formats:
- **YYMMDD** (6 digits): Versioned documents (with V# suffix)
- **YYMMDDHHMM** (10 digits): Timestamped snapshots

Enforce: App prefix + version `-V#` or timestamp required

Full: FOLDER-REGISTRY.md, FILE-REGISTRY.md

---

## MCP TOOLS

File: ideacode_fs (create, rename, move, delete, validate, audit, bulk_rename, consolidate)
Workflow: ideacode_{specify|plan|implement|test|commit|validate}
Vision: ideacode_vision (analyze_ui, from_mockup, debug_screenshot)
Context: ideacode_{context|pattern|constitution|guided}
Analysis: ideacode_{research|think|standards}
Project: ideacode_{monorepo|skill|hashtag}

Total: 23 tools | Blocked: Write, mv, rm

Ref: `docs/manuals/user/features/IDEACODE-MCPToolsReference-*.md`

---

## UI FRAMEWORK

Stack:
- Android: Compose + Material3
- iOS: SwiftUI
- Web: React + Tailwind
- Override: MagicUI (all platforms)

Input (ALL platforms REQUIRED): Voice, Touch, Gaze, Keyboard, Mouse
Optional: Eye tracking (iOS/Android), Gestures (glasses)
Glasses: Standalone/Tethered (Rokid, Xreal, Viture, RayNeo)

Command: /icreateui .app "name"
Pipeline: Requirements → Research → Design → ASCII → Code → Demo → Verify

Full: `LD-IDEACODE-UI-Guidelines-V3.md`
Manual: `docs/manuals/developer/ui/IDEACODE-UI-Implementation-Guide-V3-*.md`

---

## QUALITY GATES

| Metric | Target |
|--------|--------|
| Test coverage | 90%+ |
| Blockers | 0 |
| Warnings | 0 |
| Gaze accuracy | 95%+ <50px |

---

## IDC & PROFILES

IDC: Compact config (60-80% smaller than YAML)
Codes: PRJ: PRF: CFG: THR: SIG: VRF: GAT: AGT: CMD:
Separators: `:` fields, `+` multi-value, `,` lists
Files: `.ideacode/config.idc`
Spec: `docs/specifications/IDC-FORMAT-SPEC-V1.md`

Profiles:
- default: TDD 50, OOD 40, auto-verify
- strict: TDD 30, OOD 30, auto-verify, visual
- prototype: TDD 90, OOD 80, no verify
- production: TDD 40, OOD 40, auto-verify, visual

Usage: /idevelop .profile strict "feature"
Verifiers: spec-verifier, plan-verifier, impl-verifier (auto-run after phases)

---

Author: Manoj Jhawar | License: Proprietary | Version: 10.3 | Updated: 2025-12-06
